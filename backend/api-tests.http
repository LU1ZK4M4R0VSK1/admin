###############################################################################
# API TESTS - Analytics Backend
# Compat√≠vel com: VS Code REST Client, Insomnia, HTTPie
# 
# INSTRU√á√ïES:
# 1. Instale a extens√£o "REST Client" no VS Code
# 2. Execute as requisi√ß√µes em ordem (bot√£o "Send Request" acima de cada ###)
# 3. Os IDs retornados s√£o salvos em vari√°veis para uso nas pr√≥ximas requests
# 4. Verifique os responses para confirmar persist√™ncia no banco
###############################################################################

@baseUrl = http://localhost:5000/api
@contentType = application/json

###############################################################################
# ü™ë TESTES DE MESAS (TABLES)
# Executar primeiro para ter mesas dispon√≠veis para os pedidos
###############################################################################

### 1Ô∏è‚É£ CRIAR MESA #1 - Status Dispon√≠vel
# Objetivo: Criar mesa inicial para testes de pedidos
# Valida√ß√£o: Status 201, retorna ID da mesa criada
POST {{baseUrl}}/tables
Content-Type: {{contentType}}

{
  "tableNumber": 1,
  "capacity": 4,
  "status": 0,
  "location": "Sal√£o Principal - Janela",
  "currentWaiter": "Jo√£o Silva"
}

### 2Ô∏è‚É£ CRIAR MESA #2 - Status Dispon√≠vel
# Objetivo: Criar segunda mesa para testes
POST {{baseUrl}}/tables
Content-Type: {{contentType}}

{
  "tableNumber": 2,
  "capacity": 2,
  "status": 0,
  "location": "Sal√£o Principal - Centro"
}

### 3Ô∏è‚É£ CRIAR MESA #3 - Status Reservada
# Objetivo: Testar cria√ß√£o de mesa com status diferente
POST {{baseUrl}}/tables
Content-Type: {{contentType}}

{
  "tableNumber": 3,
  "capacity": 6,
  "status": 2,
  "location": "√Årea VIP",
  "currentWaiter": "Maria Santos"
}

### 4Ô∏è‚É£ LISTAR TODAS AS MESAS
# Objetivo: Verificar se todas as mesas foram criadas
# Valida√ß√£o: Status 200, retorna array com 3 mesas
GET {{baseUrl}}/tables

### 5Ô∏è‚É£ BUSCAR MESA POR ID
# Objetivo: Verificar detalhes de uma mesa espec√≠fica
# Valida√ß√£o: Status 200, retorna dados completos da mesa
GET {{baseUrl}}/tables/1

### 6Ô∏è‚É£ BUSCAR MESA POR N√öMERO
# Objetivo: Testar busca por n√∫mero da mesa
# Valida√ß√£o: Status 200, retorna mesa #2
GET {{baseUrl}}/tables/number/2

### 7Ô∏è‚É£ ATUALIZAR STATUS DA MESA PARA OCUPADA
# Objetivo: Simular ocupa√ß√£o da mesa
# Valida√ß√£o: Status 200, mesa muda para status Ocupada (1)
PUT {{baseUrl}}/tables/1
Content-Type: {{contentType}}

{
  "tableNumber": 1,
  "capacity": 4,
  "status": 1,
  "location": "Sal√£o Principal - Janela",
  "currentWaiter": "Jo√£o Silva",
  "occupiedSince": "2025-12-27T18:30:00"
}

### 8Ô∏è‚É£ FILTRAR MESAS POR STATUS (Dispon√≠veis)
# Objetivo: Listar apenas mesas dispon√≠veis
# Valida√ß√£o: Status 200, retorna apenas mesa #2
GET {{baseUrl}}/tables?status=0

### 9Ô∏è‚É£ FILTRAR MESAS POR STATUS (Ocupadas)
# Objetivo: Listar apenas mesas ocupadas
# Valida√ß√£o: Status 200, retorna apenas mesa #1
GET {{baseUrl}}/tables?status=1


###############################################################################
# üçΩÔ∏è TESTES DE CARD√ÅPIO (MENU ITEMS)
# Executar antes dos pedidos para ter itens dispon√≠veis
###############################################################################

### 1Ô∏è‚É£0Ô∏è‚É£ CRIAR ITEM - Categoria: Entradas
# Objetivo: Criar entrada no card√°pio
# Valida√ß√£o: Status 201, confirma cria√ß√£o com ID
POST {{baseUrl}}/menuitems
Content-Type: {{contentType}}

{
  "name": "Bruschetta Italiana",
  "description": "P√£o italiano tostado com tomate fresco, manjeric√£o e azeite",
  "price": 18.90,
  "category": "Entradas",
  "imageUrl": "https://exemplo.com/bruschetta.jpg",
  "isAvailable": true,
  "preparationTimeMinutes": 10,
  "ingredients": "P√£o italiano, tomate, manjeric√£o, alho, azeite",
  "allergens": "Gl√∫ten"
}

### 1Ô∏è‚É£1Ô∏è‚É£ CRIAR ITEM - Categoria: Pratos principais
# Objetivo: Criar prato principal
POST {{baseUrl}}/menuitems
Content-Type: {{contentType}}

{
  "name": "Risoto de Camar√£o",
  "description": "Arroz arb√≥reo cremoso com camar√µes frescos e a√ßafr√£o",
  "price": 65.90,
  "category": "Pratos principais",
  "imageUrl": "https://exemplo.com/risoto.jpg",
  "isAvailable": true,
  "preparationTimeMinutes": 30,
  "ingredients": "Arroz arb√≥reo, camar√£o, cebola, alho, vinho branco, a√ßafr√£o, queijo parmes√£o",
  "allergens": "Crust√°ceos, Lactose"
}

### 1Ô∏è‚É£2Ô∏è‚É£ CRIAR ITEM - Categoria: Bebidas
# Objetivo: Criar bebida no card√°pio
POST {{baseUrl}}/menuitems
Content-Type: {{contentType}}

{
  "name": "Suco Natural de Laranja",
  "description": "Suco de laranja puro, sem a√ß√∫car adicionado",
  "price": 12.00,
  "category": "Bebidas",
  "imageUrl": "https://exemplo.com/suco-laranja.jpg",
  "isAvailable": true,
  "preparationTimeMinutes": 5,
  "ingredients": "Laranja",
  "allergens": ""
}

### 1Ô∏è‚É£3Ô∏è‚É£ CRIAR ITEM - Categoria: Sobremesa
# Objetivo: Criar sobremesa
POST {{baseUrl}}/menuitems
Content-Type: {{contentType}}

{
  "name": "Petit Gateau",
  "description": "Bolinho de chocolate quente com sorvete de baunilha",
  "price": 22.90,
  "category": "Sobremesa",
  "imageUrl": "https://exemplo.com/petit-gateau.jpg",
  "isAvailable": true,
  "preparationTimeMinutes": 15,
  "ingredients": "Chocolate, farinha, ovos, a√ß√∫car, manteiga",
  "allergens": "Gl√∫ten, Lactose, Ovos"
}

### 1Ô∏è‚É£4Ô∏è‚É£ LISTAR TODOS OS ITENS DO CARD√ÅPIO
# Objetivo: Verificar todos os itens criados
# Valida√ß√£o: Status 200, retorna 4 itens
GET {{baseUrl}}/menuitems

### 1Ô∏è‚É£5Ô∏è‚É£ BUSCAR ITEM POR ID
# Objetivo: Verificar detalhes de um item espec√≠fico
# Valida√ß√£o: Status 200, retorna dados completos do item
GET {{baseUrl}}/menuitems/1

### 1Ô∏è‚É£6Ô∏è‚É£ FILTRAR POR CATEGORIA - Pratos principais
# Objetivo: Listar apenas pratos principais
# Valida√ß√£o: Status 200, retorna apenas o Risoto
GET {{baseUrl}}/menuitems?category=Pratos principais

### 1Ô∏è‚É£7Ô∏è‚É£ FILTRAR POR CATEGORIA - Bebidas
# Objetivo: Listar apenas bebidas
# Valida√ß√£o: Status 200, retorna apenas o Suco
GET {{baseUrl}}/menuitems?category=Bebidas

### 1Ô∏è‚É£8Ô∏è‚É£ BUSCAR POR NOME (Search)
# Objetivo: Testar busca por texto
# Valida√ß√£o: Status 200, retorna itens com "chocolate" no nome/descri√ß√£o
GET {{baseUrl}}/menuitems?search=chocolate

### 1Ô∏è‚É£9Ô∏è‚É£ LISTAR CATEGORIAS DISPON√çVEIS
# Objetivo: Obter lista de todas as categorias v√°lidas
# Valida√ß√£o: Status 200, retorna array com 4 categorias
GET {{baseUrl}}/menuitems/categories

### 2Ô∏è‚É£0Ô∏è‚É£ OBTER ESTAT√çSTICAS DO CARD√ÅPIO
# Objetivo: Ver resumo do card√°pio
# Valida√ß√£o: Status 200, retorna total de itens, dispon√≠veis, etc
GET {{baseUrl}}/menuitems/stats

### 2Ô∏è‚É£1Ô∏è‚É£ ATUALIZAR ITEM DO CARD√ÅPIO
# Objetivo: Alterar pre√ßo e disponibilidade
# Valida√ß√£o: Status 200, confirma atualiza√ß√£o
PUT {{baseUrl}}/menuitems/1
Content-Type: {{contentType}}

{
  "name": "Bruschetta Italiana",
  "description": "P√£o italiano tostado com tomate fresco, manjeric√£o e azeite especial",
  "price": 19.90,
  "category": "Entradas",
  "imageUrl": "https://exemplo.com/bruschetta.jpg",
  "isAvailable": true,
  "preparationTimeMinutes": 10,
  "ingredients": "P√£o italiano, tomate, manjeric√£o, alho, azeite extravirgem",
  "allergens": "Gl√∫ten"
}

### 2Ô∏è‚É£2Ô∏è‚É£ ALTERNAR DISPONIBILIDADE (Toggle Availability)
# Objetivo: Marcar item como indispon√≠vel
# Valida√ß√£o: Status 200, isAvailable muda para false
PATCH {{baseUrl}}/menuitems/2/toggle-availability

### 2Ô∏è‚É£3Ô∏è‚É£ VERIFICAR ITEM INDISPON√çVEL
# Objetivo: Confirmar que item est√° indispon√≠vel
# Valida√ß√£o: isAvailable = false
GET {{baseUrl}}/menuitems/2

### 2Ô∏è‚É£4Ô∏è‚É£ REATIVAR ITEM (Toggle Availability novamente)
# Objetivo: Marcar item como dispon√≠vel novamente
PATCH {{baseUrl}}/menuitems/2/toggle-availability


###############################################################################
# üì¶ TESTES DE PEDIDOS (ORDERS)
# Executar ap√≥s criar mesas e itens do card√°pio
###############################################################################

### 2Ô∏è‚É£5Ô∏è‚É£ CRIAR PEDIDO #1 - Status inicial: Em Andamento
# Objetivo: Criar pedido associado √† Mesa #1
# Valida√ß√£o: 
#   - Status 201
#   - Status do pedido = 0 (EmAndamento)
#   - Retorna ID, CreatedAt, TableId = 1
#   - TotalAmount calculado corretamente
POST {{baseUrl}}/orders
Content-Type: {{contentType}}

{
  "tableId": 1,
  "items": [
    {
      "productName": "Bruschetta Italiana",
      "quantity": 2,
      "unitPrice": 19.90,
      "notes": "Sem alho"
    },
    {
      "productName": "Risoto de Camar√£o",
      "quantity": 1,
      "unitPrice": 65.90
    },
    {
      "productName": "Suco Natural de Laranja",
      "quantity": 2,
      "unitPrice": 12.00
    }
  ],
  "customerNotes": "Cliente aniversariante - preparar surpresa"
}

### 2Ô∏è‚É£6Ô∏è‚É£ CRIAR PEDIDO #2 - Mesa #2
# Objetivo: Criar segundo pedido para teste de listagem
POST {{baseUrl}}/orders
Content-Type: {{contentType}}

{
  "tableId": 2,
  "items": [
    {
      "productName": "Petit Gateau",
      "quantity": 1,
      "unitPrice": 22.90
    }
  ],
  "customerNotes": ""
}

### 2Ô∏è‚É£7Ô∏è‚É£ LISTAR TODOS OS PEDIDOS
# Objetivo: Verificar se ambos os pedidos foram criados
# Valida√ß√£o: Status 200, retorna array com 2 pedidos
GET {{baseUrl}}/orders

### 2Ô∏è‚É£8Ô∏è‚É£ BUSCAR PEDIDO POR ID
# Objetivo: Verificar detalhes completos do pedido #1
# Valida√ß√£o: 
#   - Status 200
#   - Retorna itens do pedido
#   - Retorna dados da mesa
#   - Status = EmAndamento
GET {{baseUrl}}/orders/1

### 2Ô∏è‚É£9Ô∏è‚É£ FILTRAR PEDIDOS POR STATUS - Em Andamento
# Objetivo: Listar apenas pedidos em andamento
# Valida√ß√£o: Status 200, retorna os 2 pedidos criados
GET {{baseUrl}}/orders?status=0

### 3Ô∏è‚É£0Ô∏è‚É£ FILTRAR PEDIDOS POR MESA
# Objetivo: Listar pedidos da Mesa #1
# Valida√ß√£o: Status 200, retorna apenas pedido #1
GET {{baseUrl}}/orders?tableId=1

### 3Ô∏è‚É£1Ô∏è‚É£ EDITAR PEDIDO #1 - Adicionar item
# Objetivo: Testar edi√ß√£o de pedido em andamento
# Valida√ß√£o: Status 200, pedido atualizado com novo item
PUT {{baseUrl}}/orders/1
Content-Type: {{contentType}}

{
  "tableId": 1,
  "items": [
    {
      "productName": "Bruschetta Italiana",
      "quantity": 2,
      "unitPrice": 19.90,
      "notes": "Sem alho"
    },
    {
      "productName": "Risoto de Camar√£o",
      "quantity": 1,
      "unitPrice": 65.90
    },
    {
      "productName": "Suco Natural de Laranja",
      "quantity": 2,
      "unitPrice": 12.00
    },
    {
      "productName": "Petit Gateau",
      "quantity": 1,
      "unitPrice": 22.90,
      "notes": "Com sorvete extra"
    }
  ],
  "customerNotes": "Cliente aniversariante - preparar surpresa"
}

### 3Ô∏è‚É£2Ô∏è‚É£ ALTERAR STATUS PARA ENTREGUE
# Objetivo: Mudar status do pedido #1
# Valida√ß√£o: 
#   - Status 200
#   - Status muda para 2 (Entregue)
#   - DeliveredAt √© preenchido com timestamp
#   - Hist√≥rico de status √© criado
PATCH {{baseUrl}}/orders/1/status
Content-Type: {{contentType}}

{
  "newStatus": 2,
  "notes": "Pedido entregue pelo gar√ßom Jo√£o",
  "changedBy": "Jo√£o Silva"
}

### 3Ô∏è‚É£3Ô∏è‚É£ VERIFICAR HIST√ìRICO DE STATUS
# Objetivo: Confirmar que o hist√≥rico foi salvo
# Valida√ß√£o: 
#   - Status atual = Entregue
#   - DeliveredAt preenchido
#   - StatusHistory cont√©m mudan√ßa EmAndamento ‚Üí Entregue
GET {{baseUrl}}/orders/1

### 3Ô∏è‚É£4Ô∏è‚É£ ALTERAR STATUS PARA PAGO
# Objetivo: Finalizar pedido como pago
# Valida√ß√£o:
#   - Status 200
#   - Status muda para 3 (Pago)
#   - PaidAt √© preenchido
#   - Hist√≥rico registra Entregue ‚Üí Pago
PATCH {{baseUrl}}/orders/1/status
Content-Type: {{contentType}}

{
  "newStatus": 3,
  "notes": "Pagamento efetuado com cart√£o",
  "changedBy": "Caixa - Ana Costa"
}

### 3Ô∏è‚É£5Ô∏è‚É£ TENTAR EDITAR PEDIDO PAGO - DEVE FALHAR
# Objetivo: Validar regra de neg√≥cio (n√£o pode editar pedido pago)
# Valida√ß√£o: Status 400, mensagem de erro informando que n√£o pode editar
PUT {{baseUrl}}/orders/1
Content-Type: {{contentType}}

{
  "tableId": 1,
  "items": [
    {
      "productName": "Teste",
      "quantity": 1,
      "unitPrice": 10.00
    }
  ],
  "customerNotes": "Tentando editar pedido pago"
}

### 3Ô∏è‚É£6Ô∏è‚É£ TENTAR ALTERAR STATUS DE PEDIDO PAGO - DEVE FALHAR
# Objetivo: Validar que n√£o pode mudar status de pedido pago
# Valida√ß√£o: Status 400, erro informando que pedido j√° est√° pago
PATCH {{baseUrl}}/orders/1/status
Content-Type: {{contentType}}

{
  "newStatus": 0,
  "notes": "Tentando voltar status",
  "changedBy": "Sistema"
}

### 3Ô∏è‚É£7Ô∏è‚É£ CANCELAR PEDIDO #2
# Objetivo: Testar cancelamento de pedido
# Valida√ß√£o:
#   - Status 200
#   - Status muda para 1 (Cancelado)
#   - CancelledAt √© preenchido
PATCH {{baseUrl}}/orders/2/status
Content-Type: {{contentType}}

{
  "newStatus": 1,
  "notes": "Cliente desistiu do pedido",
  "changedBy": "Maria Santos"
}

### 3Ô∏è‚É£8Ô∏è‚É£ FILTRAR PEDIDOS POR STATUS - Pago
# Objetivo: Listar apenas pedidos pagos
# Valida√ß√£o: Status 200, retorna apenas pedido #1
GET {{baseUrl}}/orders?status=3

### 3Ô∏è‚É£9Ô∏è‚É£ FILTRAR PEDIDOS POR STATUS - Cancelado
# Objetivo: Listar apenas pedidos cancelados
# Valida√ß√£o: Status 200, retorna apenas pedido #2
GET {{baseUrl}}/orders?status=1


###############################################################################
# üìä TESTES DE MESAS COM PEDIDOS VINCULADOS
# Verificar relacionamento entre mesas e pedidos
###############################################################################

### 4Ô∏è‚É£0Ô∏è‚É£ BUSCAR MESA #1 COM PEDIDOS
# Objetivo: Verificar pedidos vinculados √† mesa
# Valida√ß√£o:
#   - Status 200
#   - Retorna pedido #1 associado
#   - Mostra TotalOrders e ActiveOrders
GET {{baseUrl}}/tables/1

### 4Ô∏è‚É£1Ô∏è‚É£ OBTER ESTAT√çSTICAS DA MESA #1
# Objetivo: Ver tempo de ocupa√ß√£o e dura√ß√£o dos pedidos
# Valida√ß√£o:
#   - Status 200
#   - Retorna tempo total desde ocupa√ß√£o
#   - Lista pedidos com tempo por status
#   - Mostra OrderTimeDto com StatusDurations
GET {{baseUrl}}/tables/1/stats

### 4Ô∏è‚É£2Ô∏è‚É£ BUSCAR MESA #2 COM PEDIDOS
# Objetivo: Verificar pedido cancelado na mesa #2
GET {{baseUrl}}/tables/2

### 4Ô∏è‚É£3Ô∏è‚É£ CRIAR NOVO PEDIDO NA MESA #1
# Objetivo: Testar m√∫ltiplos pedidos na mesma mesa
POST {{baseUrl}}/orders
Content-Type: {{contentType}}

{
  "tableId": 1,
  "items": [
    {
      "productName": "Suco Natural de Laranja",
      "quantity": 3,
      "unitPrice": 12.00
    }
  ],
  "customerNotes": "Pedido adicional"
}

### 4Ô∏è‚É£4Ô∏è‚É£ VERIFICAR MESA #1 COM M√öLTIPLOS PEDIDOS
# Objetivo: Confirmar que mesa mostra todos os pedidos
# Valida√ß√£o: TotalOrders >= 2
GET {{baseUrl}}/tables/1


###############################################################################
# üóëÔ∏è TESTES DE EXCLUS√ÉO
# Executar por √∫ltimo para n√£o afetar outros testes
###############################################################################

### 4Ô∏è‚É£5Ô∏è‚É£ EXCLUIR PEDIDO #2
# Objetivo: Remover pedido cancelado
# Valida√ß√£o: Status 204 (No Content)
DELETE {{baseUrl}}/orders/2

### 4Ô∏è‚É£6Ô∏è‚É£ VERIFICAR PEDIDO EXCLU√çDO
# Objetivo: Confirmar que pedido n√£o existe mais
# Valida√ß√£o: Status 404
GET {{baseUrl}}/orders/2

### 4Ô∏è‚É£7Ô∏è‚É£ EXCLUIR ITEM DO CARD√ÅPIO #4
# Objetivo: Remover sobremesa do card√°pio
# Valida√ß√£o: Status 204
DELETE {{baseUrl}}/menuitems/4

### 4Ô∏è‚É£8Ô∏è‚É£ VERIFICAR ITEM EXCLU√çDO
# Objetivo: Confirmar que item n√£o existe mais
# Valida√ß√£o: Status 404
GET {{baseUrl}}/menuitems/4

### 4Ô∏è‚É£9Ô∏è‚É£ TENTAR EXCLUIR MESA COM PEDIDOS - PODE FALHAR
# Objetivo: Testar exclus√£o de mesa com pedidos ativos
# Obs: Depende da configura√ß√£o de cascade no banco
DELETE {{baseUrl}}/tables/1

### 5Ô∏è‚É£0Ô∏è‚É£ EXCLUIR MESA SEM PEDIDOS
# Objetivo: Remover mesa #3 que n√£o tem pedidos
# Valida√ß√£o: Status 204
DELETE {{baseUrl}}/tables/3


###############################################################################
# ‚úÖ TESTES FINAIS - VALIDA√á√ÉO COMPLETA
###############################################################################

### 5Ô∏è‚É£1Ô∏è‚É£ LISTAR TODOS OS PEDIDOS RESTANTES
# Objetivo: Ver estado final dos pedidos
GET {{baseUrl}}/orders

### 5Ô∏è‚É£2Ô∏è‚É£ LISTAR TODAS AS MESAS RESTANTES
# Objetivo: Ver estado final das mesas
GET {{baseUrl}}/tables

### 5Ô∏è‚É£3Ô∏è‚É£ LISTAR TODOS OS ITENS DO CARD√ÅPIO RESTANTES
# Objetivo: Ver estado final do card√°pio
GET {{baseUrl}}/menuitems


###############################################################################
# üìã CHECKLIST DE VALIDA√á√ÉO
###############################################################################
# 
# ‚úÖ PEDIDOS:
#   ‚ñ° Pedidos s√£o criados com status EmAndamento (0)
#   ‚ñ° CreatedAt √© preenchido automaticamente
#   ‚ñ° TotalAmount √© calculado corretamente
#   ‚ñ° Edi√ß√£o funciona apenas quando status ‚â† Pago
#   ‚ñ° Mudan√ßa de status gera hist√≥rico (OrderStatusHistory)
#   ‚ñ° Timestamps s√£o salvos: PaidAt, CancelledAt, DeliveredAt
#   ‚ñ° Hist√≥rico retorna FromStatus, ToStatus, ChangedAt, Notes, ChangedBy
#   ‚ñ° N√£o permite editar nem mudar status de pedido Pago
#
# ‚úÖ MESAS:
#   ‚ñ° Mesas s√£o criadas com status correto (Dispon√≠vel, Ocupada, Reservada)
#   ‚ñ° Pedidos s√£o vinculados corretamente √†s mesas
#   ‚ñ° TotalOrders conta todos os pedidos da mesa
#   ‚ñ° ActiveOrders conta apenas pedidos n√£o finalizados
#   ‚ñ° Stats retorna tempo desde ocupa√ß√£o
#   ‚ñ° Stats mostra dura√ß√£o de cada pedido por status
#   ‚ñ° OrderTimeDto cont√©m StatusDurations detalhado
#
# ‚úÖ CARD√ÅPIO:
#   ‚ñ° Itens s√£o criados com categoria v√°lida (Entradas, Bebidas, Pratos principais, Sobremesa)
#   ‚ñ° Ingredientes s√£o salvos corretamente
#   ‚ñ° Filtro por categoria funciona
#   ‚ñ° Busca por nome/descri√ß√£o funciona
#   ‚ñ° Toggle availability alterna isAvailable
#   ‚ñ° Stats retorna total, dispon√≠veis, etc
#
# ‚úÖ FRONT-END COMPATIBILITY:
#   ‚ñ° Dados retornados possuem todos os campos necess√°rios
#   ‚ñ° Formato de data √© consistente (ISO 8601)
#   ‚ñ° Status s√£o enums num√©ricos (0, 1, 2, 3)
#   ‚ñ° Arrays e objetos relacionados s√£o inclu√≠dos nas respostas
#   ‚ñ° N√£o h√° refer√™ncias circulares (ReferenceHandler.IgnoreCycles)
#
###############################################################################
